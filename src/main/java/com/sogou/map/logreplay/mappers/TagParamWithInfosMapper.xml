<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.sogou.map.logreplay.mappers.TagParamWithInfosMapper">
	
	<resultMap id="TagParamWithInfosResult" type="TagParam" >
		<id 	property="id" 			column="tag_param_id" />
		<result property="tagInfoId"	column="tag_info_id" />
		<result property="comment"		column="comment" />
		<collection property="paramInfoList" ofType="ParamInfo">
			<id		property="id"			column="param_info_id"/>
			<result	property="tagParamId"	column="tag_param_id"/>
			<result	property="name"			column="name"/>
			<result	property="value"		column="value"/>
			<result	property="description"	column="description"/>
		</collection>
	</resultMap>
	
	<select id="list" resultMap="TagParamWithInfosResult">
		<include refid="select" />
		<include refid="from" />
		<include refid="where" />
		<include refid="CommonMapper.orderBy" />
		<include refid="CommonMapper.limit" />
	</select>
	
	<sql id="select">
		select tag_param.id as tag_param_id,
			tag_param.tag_info_id,
			tag_param.comment,
			param_info.id as param_info_id,
			param_info.tag_param_id,
			param_info.name,
			param_info.value,
			param_info.description
	</sql>
	<sql id="from">
		from tag_param
			left join param_info on tag_param.id = param_info.tag_param_id 
	</sql>	
	<sql id="where">
		<where>
			<if test="tagInfoId != null">
				and tag_param.tag_info_id = #{tagInfoId}
			</if>
			<if test="tagInfoId__in != null">
				and tag_param.tag_info_id in
				<foreach collection="tagInfoId__in"
					item="tagInfoId"
					separator=","
					open="(" close=")">
					#{tagInfoId}
				</foreach>
			</if> 
		</where>
	</sql>
</mapper>